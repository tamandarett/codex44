<!DOCTYPE html>
<html>
<head>
  <title>Gerador de Link PIX Único</title>
  <style>
    body { font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto; padding: 20px; }
    textarea { width: 100%; height: 100px; margin-bottom: 10px; }
    button { background: #4285F4; color: white; border: none; padding: 10px 15px; cursor: pointer; }
    #resultado { margin-top: 20px; word-break: break-all; }
  </style>
</head>
<body>
  <h1>Gerador de Link PIX</h1>
  <textarea id="codigoPix" placeholder="Cole o código PIX aqui..."></textarea>
  <button onclick="encurtar()">Gerar Link Encurtado</button>
  <div id="resultado"></div>

  <script>
    async function encurtar() {
      const codigoPix = document.getElementById('codigoPix').value.trim();
      if (!codigoPix) {
        alert("Por favor, cole o código PIX!");
        return;
      }

      // Adiciona um parâmetro único (timestamp + número aleatório)
      const uniqueParam = Date.now() + "-" + Math.floor(Math.random() * 1000);
      const urlCompleta = `https://tamandarett.github.io/pix-pagina/pix.html?codigo=${encodeURIComponent(codigoPix)}&ref=${uniqueParam}`;
      const resultadoDiv = document.getElementById('resultado');
      
      try {
        // Usa is.gd (ou outro serviço)
        const response = await fetch(`https://is.gd/create.php?format=json&url=${encodeURIComponent(urlCompleta)}`);
        const data = await response.json();
        
        resultadoDiv.innerHTML = `
          <p><strong>Link encurtado (único):</strong></p>
          <input type="text" value="${data.shorturl}" id="linkGerado" readonly style="width: 100%; padding: 5px;">
          <button onclick="copiarLink()">Copiar</button>
        `;
      } catch (error) {
        resultadoDiv.innerHTML = "<p>Erro ao encurtar. Recarregue a página e tente novamente.</p>";
      }
    }

    function copiarLink() {
      const link = document.getElementById("linkGerado");
      link.select();
      document.execCommand("copy");
      alert("Link copiado!");
    }
  </script>
</body>
</html>
